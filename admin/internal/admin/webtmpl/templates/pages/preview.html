{{define "pages/preview"}}
{{template "layouts/base" .}}
{{end}}

{{define "pages/preview-content"}}
<div class="space-y-6">
  {{template "pages/preview-header" .Header}}
  {{template "pages/preview-viewport" .Content}}
</div>
{{end}}

{{define "pages/preview-header"}}
  <section class="rounded-2xl border border-slate-200 bg-white px-6 py-5 shadow-sm">
    <div class="flex flex-col gap-4 lg:flex-row lg:items-start lg:justify-between">
      <div class="space-y-2">
        <p class="text-xs font-semibold uppercase tracking-wide text-slate-500">ページプレビュー</p>
        <h1 class="text-3xl font-semibold text-slate-900">{{.Title}}</h1>
        <div class="flex flex-wrap items-center gap-3 text-sm text-slate-500">
          <span class="{{badgeClass .StatusTone}}">{{.StatusLabel}}</span>
          {{if .UpdatedRelative}}
            <span>最終更新 {{.UpdatedRelative}}</span>
          {{end}}
          {{if .UpdatedExact}}
            <span class="hidden md:inline text-slate-400">({{.UpdatedExact}})</span>
          {{end}}
        </div>
      </div>
      <div class="flex flex-col items-end gap-3">
        {{template "pages/preview-locale-switcher" .LocaleOptions}}
        <div class="flex flex-wrap justify-end gap-2 text-xs">
          {{if .ShareURL}}
            <a href="{{.ShareURL}}" target="_blank" rel="noreferrer" class="{{buttonClass "secondary" "sm" false false}}">
              共有リンク
            </a>
          {{end}}
          {{if .ExternalURL}}
            <a href="{{.ExternalURL}}" target="_blank" rel="noreferrer" class="{{buttonClass "ghost" "sm" false false}}">
              公開ページを開く
            </a>
          {{end}}
        </div>
      </div>
    </div>
  </section>
{{end}}

{{define "pages/preview-viewport"}}
  <section class="rounded-2xl border border-slate-200 bg-white shadow-sm">
    <div class="flex flex-wrap items-center justify-between gap-3 border-b border-slate-200 px-6 py-3">
      <div>
        <p class="text-xs font-semibold uppercase tracking-wide text-slate-500">プレビュー</p>
      </div>
      {{template "pages/preview-locale-switcher" .Locales}}
    </div>
    <div class="space-y-6 px-6 py-6">
      {{template "pages/preview-hero" .HeroHTML}}
      <article class="prose prose-slate max-w-none">
        {{.BodyHTML}}
      </article>
      {{if gt (len .Notes) 0}}
        <div class="rounded-xl border border-amber-200 bg-amber-50 p-4 text-sm text-amber-700">
          <ul class="list-disc space-y-1 pl-5">
            {{range $note := .Notes}}
              <li>{{$note}}</li>
            {{end}}
          </ul>
        </div>
      {{end}}
    </div>
  </section>
{{end}}

{{define "pages/preview-hero"}}
  {{if .}}
    <div class="overflow-hidden rounded-2xl border border-slate-200 bg-slate-900 text-white shadow-sm">
      {{.}}
    </div>
  {{end}}
{{end}}

{{define "pages/preview-locale-switcher"}}
  {{if gt (len .) 0}}
    <div class="inline-flex items-center gap-1 rounded-full bg-slate-100 p-1 text-xs font-semibold text-slate-600">
      {{range $option := .}}
        <a href="{{$option.URL}}" class="{{previewLocaleClass $option.Active}}">{{$option.Label}}</a>
      {{end}}
    </div>
  {{end}}
{{end}}
