{{define "production/board"}}
<section
  id="{{.ContainerID}}"
  class="space-y-4"
  data-production-shell
  data-board-refresh="{{.RefreshURL}}"
  data-board-query="{{.Query.RawQuery}}"
  data-refresh-interval="{{printf "%d" .RefreshInterval}}"
  hx-target="this"
>
  <div class="flex flex-wrap items-center justify-between gap-3 text-xs text-slate-500">
    <div>æœ€çµ‚æ›´æ–° {{.LastUpdatedLabel}}</div>
    <div class="flex items-center gap-2">
      <span class="inline-flex items-center gap-1 rounded-full border border-slate-200 px-3 py-1 text-xs font-medium text-slate-600">
        ğŸ“ {{.Queue.Location}}
      </span>
      {{if .Queue.Shift}}
        <span class="inline-flex items-center gap-1 rounded-full border border-slate-200 px-3 py-1 text-xs font-medium text-slate-600">
          ğŸ•‘ {{.Queue.Shift}}
        </span>
      {{end}}
    </div>
  </div>
  {{template "production/error-notice" .Error}}
  <p id="{{productionBoardInstructionsDomID .BoardID}}" class="sr-only">
    ã‚«ãƒ¼ãƒ‰ã«ãƒ•ã‚©ãƒ¼ã‚«ã‚¹ã—ãŸçŠ¶æ…‹ã§å·¦å³ã‚­ãƒ¼ã§ã‚¹ãƒ†ãƒ¼ã‚¸ã‚’ç§»å‹•ã—ã€Enterã‚­ãƒ¼ã§è©³ç´°ã‚’é–‹ãã¾ã™ã€‚ãƒ‰ãƒ©ãƒƒã‚°ï¼†ãƒ‰ãƒ­ãƒƒãƒ—ã«ã‚‚å¯¾å¿œã—ã¦ã„ã¾ã™ã€‚
  </p>
  <div class="grid gap-6 lg:grid-cols-[minmax(0,1fr)_320px]">
    <div
      id="{{.BoardID}}"
      class="space-y-4"
      role="region"
      aria-label="{{productionBoardAriaLabel .Queue}}"
      aria-describedby="{{productionBoardInstructionsDomID .BoardID}}"
      data-production-board
      data-selected="{{.Query.Selected}}"
    >
      <div class="grid gap-4 md:grid-cols-2 xl:grid-cols-5">
        {{range .Lanes}}
          <section
            class="flex h-full flex-col rounded-2xl border border-slate-200 bg-white p-4"
            data-production-lane
            data-stage="{{.Stage}}"
            data-lane-label="{{.Label}}"
            role="region"
            aria-labelledby="{{productionLaneHeadingDomID $.BoardID .Stage .Label}}"
            aria-describedby="{{productionLaneMetaDomID $.BoardID .Stage}}"
          >
            <div class="flex items-center justify-between">
              <div>
                <h2 id="{{productionLaneHeadingDomID $.BoardID .Stage .Label}}" class="text-sm font-semibold text-slate-900">{{.Label}}</h2>
                <p class="text-xs text-slate-500">{{.Description}}</p>
              </div>
              <div class="text-right">
                <p class="text-xs font-medium text-slate-500">å®¹é‡</p>
                <p class="text-sm font-semibold text-slate-900">{{.CapacityLabel}}</p>
              </div>
            </div>
            <div class="mt-3 h-1.5 w-full rounded-full bg-slate-100">
              <div class="h-full rounded-full bg-brand-500" style="{{printf "width:%d%%" (minInt .CapacityPercent 100)}}"></div>
            </div>
            <p id="{{productionLaneMetaDomID $.BoardID .Stage}}" class="sr-only">
              {{productionLaneAssistiveDescription .}}
            </p>
            <div class="mt-4 space-y-3" data-production-cards role="list" aria-label="{{printf "%s ã®ã‚«ãƒ¼ãƒ‰" .Label}}">
              {{if eq (len .Cards) 0}}
                <div class="rounded-xl border border-dashed border-slate-200 bg-slate-50 px-3 py-6 text-center text-xs text-slate-500">{{.EmptyMessage}}</div>
              {{end}}
              {{range .Cards}}
                {{template "production/kanban-card" .}}
              {{end}}
            </div>
          </section>
        {{end}}
      </div>
    </div>
    <aside id="{{.DrawerID}}" class="rounded-2xl border border-slate-200 bg-white p-4" data-production-drawer>
      {{if .Drawer.Empty}}
        <div class="flex h-full flex-col items-center justify-center text-center text-sm text-slate-500">
          <p>ã‚«ãƒ¼ãƒ‰ã‚’é¸æŠã™ã‚‹ã¨è©³ç´°ãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚</p>
        </div>
      {{else}}
        {{template "production/drawer-content" .Drawer}}
      {{end}}
    </aside>
  </div>
</section>
{{end}}

{{define "production/kanban-card"}}
<div
  class="{{productionKanbanCardClass .Selected .Blocked}}"
  draggable="true"
  data-production-card
  data-order-id="{{.ID}}"
  data-order-number="{{.OrderNumber}}"
  data-stage="{{.Stage}}"
  data-endpoint="{{.Endpoint}}"
  data-card-payload="{{.Payload}}"
  data-selected="{{.Selected}}"
  role="listitem"
  aria-roledescription="ç”Ÿç”£ã‚«ãƒ¼ãƒ‰"
  aria-label="{{productionCardAriaLabel .}}"
  aria-describedby="{{productionCardMetaDomID .}}"
  aria-grabbed="false"
  tabindex="0"
>
  <div class="flex items-center justify-between">
    <p class="text-sm font-semibold text-slate-900">#{{.OrderNumber}}</p>
    <span class="{{badgeClass .PriorityTone}}">{{.PriorityLabel}}</span>
  </div>
  <p class="mt-1 text-base font-semibold text-slate-900">{{.Customer}}</p>
  <p class="text-xs text-slate-500">{{.ProductLine}} Â· {{.Design}}</p>
  {{if gt (len .Flags) 0}}
    <div class="mt-2 flex flex-wrap gap-1">
      {{range .Flags}}
        <span class="{{badgeClass .Tone}}">{{.Icon}} {{.Label}}</span>
      {{end}}
    </div>
  {{end}}
  <div class="mt-3 flex items-center justify-between text-xs">
    <span class="{{productionDueToneClass .DueTone}}">{{.DueLabel}}</span>
    <span class="text-slate-500">{{.Workstation}}</span>
  </div>
  <div class="mt-3 flex items-center -space-x-2">
    {{range .Assignees}}
      <span class="inline-flex h-7 w-7 items-center justify-center rounded-full border border-white bg-slate-800 text-xs font-semibold text-white" title="{{.Name}}">{{.Initials}}</span>
    {{end}}
  </div>
  <p id="{{productionCardMetaDomID .}}" class="sr-only">{{productionCardAssistiveMeta .}}</p>
</div>
{{end}}

{{define "production/drawer-content"}}
<div class="space-y-4">
  <div class="space-y-2">
    <div class="flex items-center justify-between">
      <h2 class="text-lg font-semibold text-slate-900">æ³¨æ–‡ #{{.Card.OrderNumber}}</h2>
      <span class="{{badgeClass .Card.PriorityTone}}">{{.Card.PriorityLabel}}</span>
    </div>
    <p class="text-sm text-slate-600">{{.Card.Customer}} / {{.Card.ProductLine}}</p>
    <div class="flex flex-wrap gap-2 text-xs">
      <span class="{{badgeClass "info"}}">{{.Card.StageLabel}}</span>
      {{if .Card.Workstation}}
        <span class="{{badgeClass "secondary"}}">{{.Card.Workstation}}</span>
      {{end}}
    </div>
  </div>
  {{if gt (len .Card.Flags) 0}}
    <div class="flex flex-wrap gap-2">
      {{range .Card.Flags}}
        <span class="{{badgeClass .Tone}}">{{.Icon}} {{.Label}}</span>
      {{end}}
    </div>
  {{end}}
  <dl class="divide-y divide-slate-100 rounded-xl border border-slate-100">
    {{range .Details}}
      <div class="flex items-center justify-between px-4 py-2">
        <dt class="text-xs font-medium text-slate-500">{{.Label}}</dt>
        <dd class="text-sm text-slate-900">{{.Value}}</dd>
      </div>
    {{end}}
  </dl>
  <div>
    <h3 class="text-sm font-semibold text-slate-900">ã‚¿ã‚¤ãƒ ãƒ©ã‚¤ãƒ³</h3>
    {{if eq (len .Timeline) 0}}
      <p class="text-xs text-slate-500">ã¾ã ã‚¤ãƒ™ãƒ³ãƒˆãŒã‚ã‚Šã¾ã›ã‚“ã€‚</p>
    {{else}}
      <ol class="mt-2 space-y-3">
        {{range .Timeline}}
          <li class="rounded-xl border border-slate-100 px-3 py-2">
            <p class="text-xs font-semibold text-slate-900">{{.StageLabel}}</p>
            <p class="text-sm text-slate-700">{{.Description}}</p>
            <p class="text-xs text-slate-500">{{.Timestamp}} Â· {{.Actor}}</p>
            {{if .Note}}
              <p class="text-xs text-slate-500">{{.Note}}</p>
            {{end}}
          </li>
        {{end}}
      </ol>
    {{end}}
  </div>
</div>
{{end}}
