{{ define "content" }}
{{ $view := $.Account }}
{{ $user := $view.User }}
<section class="py-8">
  <div class="space-y-8">
    <header class="space-y-6 rounded-3xl border border-gray-200 bg-white p-6 shadow-sm">
      <nav class="flex flex-wrap items-center gap-2 text-sm text-gray-500" aria-label="{{ if eq $.Lang "ja" }}パンくずリスト{{ else }}Breadcrumb{{ end }}">
        {{ range $i, $crumb := $.Breadcrumbs }}
          {{ if $i }}<span aria-hidden="true" class="text-gray-300">/</span>{{ end }}
          {{ if $crumb.Active }}
            <span class="font-medium text-gray-700">{{ if $crumb.LabelKey }}{{ tlang $.Lang $crumb.LabelKey }}{{ else if $crumb.Label }}{{ $crumb.Label }}{{ else }}{{ $crumb.Href }}{{ end }}</span>
          {{ else }}
            <a href="{{ $crumb.Href }}" class="hover:text-indigo-600 hover:underline">{{ if $crumb.LabelKey }}{{ tlang $.Lang $crumb.LabelKey }}{{ else if $crumb.Label }}{{ $crumb.Label }}{{ else }}{{ $crumb.Href }}{{ end }}</a>
          {{ end }}
        {{ end }}
      </nav>
      <div class="flex flex-col gap-4 lg:flex-row lg:items-center lg:justify-between">
        <div class="space-y-2">
          <p class="text-xs font-semibold uppercase tracking-wide text-indigo-500">{{ tlang $.Lang "account.page.eyebrow" }}</p>
          <h1 class="text-3xl font-bold text-gray-900 tracking-tight">{{ tlang $.Lang "nav.account" }}</h1>
          <p class="text-sm text-gray-600">{{ $view.Section.Subtitle }}</p>
        </div>
        <div class="flex flex-col gap-3 rounded-2xl border border-gray-100 bg-gray-50 p-4 sm:flex-row sm:items-center sm:gap-5">
          <div class="flex items-center gap-3">
            <img src="{{ $user.AvatarURL }}" alt="{{ $user.DisplayName }}" class="h-14 w-14 rounded-full border border-gray-200 object-cover" loading="lazy" decoding="async" srcset="{{ responsiveSrcset $user.AvatarURL 96 128 192 }}" sizes="{{ responsiveSizes "avatar" }}">
            <div>
              <p class="text-base font-semibold text-gray-900">{{ $user.DisplayName }}</p>
              <p class="text-xs text-gray-500">{{ $user.Email }}</p>
            </div>
          </div>
          <div class="flex flex-wrap gap-3 text-xs">
            <span class="inline-flex items-center rounded-full bg-indigo-50 px-3 py-1 font-semibold text-indigo-700">{{ $user.Plan }}</span>
            <span class="inline-flex items-center rounded-full bg-slate-100 px-3 py-1 font-medium text-slate-700">{{ $user.Role }}</span>
          </div>
        </div>
      </div>
    </header>

    <div class="grid gap-6 lg:grid-cols-[260px_minmax(0,1fr)]">
      <aside class="space-y-5 rounded-3xl border border-gray-200 bg-white p-5 shadow-sm">
        <div class="space-y-3">
          {{ range $item := $view.NavItems }}
            <a href="{{ $item.Href }}"
               class="block rounded-2xl border px-4 py-3 text-sm transition {{ if $item.Active }}border-indigo-200 bg-indigo-50 text-indigo-800{{ else }}border-gray-100 hover:border-indigo-200{{ end }}">
              <div class="flex items-center justify-between gap-2">
                <span class="font-semibold">{{ $item.Label }}</span>
                {{ if $item.Badge }}<span class="rounded-full bg-gray-100 px-2 py-0.5 text-xs text-gray-600">{{ $item.Badge }}</span>{{ end }}
              </div>
              <p class="mt-1 text-xs text-gray-500">{{ $item.Description }}</p>
            </a>
          {{ end }}
        </div>
        <div class="rounded-2xl border border-dashed border-gray-200 p-4 text-xs text-gray-500">
          <p class="font-semibold text-gray-700">{{ tlang $.Lang "account.help.title" }}</p>
          <p class="mt-1">{{ tlang $.Lang "account.help.body" }}</p>
          <a href="/guides" class="mt-2 inline-flex items-center gap-1 text-indigo-600 hover:text-indigo-500">
            {{ tlang $.Lang "account.help.cta" }}
            {{ template "icon" (dict "Name" "arrow-top-right-on-square" "Class" "h-4 w-4") }}
          </a>
        </div>
      </aside>

      <div class="space-y-6">
        <section class="rounded-3xl border border-gray-200 bg-white p-6 shadow-sm space-y-4">
          <header class="flex flex-col gap-1">
            <p class="text-xs font-semibold uppercase tracking-wide text-gray-500">{{ $view.Section.Eyebrow }}</p>
            <h2 class="text-2xl font-semibold text-gray-900">{{ $view.Section.Title }}</h2>
            <p class="text-sm text-gray-600">{{ $view.Section.Subtitle }}</p>
          </header>
          <ul class="divide-y divide-gray-100">
            {{ range $pref := $view.Preferences }}
              <li class="flex flex-col gap-3 py-4 sm:flex-row sm:items-center sm:justify-between">
                <div>
                  <div class="flex items-center gap-2">
                    <p class="font-medium text-gray-900">{{ $pref.Label }}</p>
                    {{ if $pref.Required }}<span class="rounded-full bg-gray-100 px-2 py-0.5 text-xs text-gray-600">{{ tlang $.Lang "account.prefs.required" }}</span>{{ end }}
                  </div>
                  <p class="text-sm text-gray-500">{{ $pref.Description }}</p>
                </div>
                <button type="button"
                        class="relative inline-flex h-7 w-14 flex-none items-center rounded-full transition data-[checked=true]:bg-indigo-600 data-[checked=false]:bg-gray-300"
                        role="switch"
                        aria-checked="{{ if $pref.Enabled }}true{{ else }}false{{ end }}"
                        {{ if $pref.Required }}disabled{{ end }}
                        data-account-switch
                        data-checked="{{ if $pref.Enabled }}true{{ else }}false{{ end }}">
                  <span class="absolute inset-0 rounded-full bg-gradient-to-tr from-white/10 to-white/40 transition opacity-0 data-[checked=true]:opacity-100"></span>
                  <span class="ml-1 inline-block h-5 w-5 rounded-full bg-white shadow transition data-[checked=true]:translate-x-7 data-[checked=false]:translate-x-0"></span>
                </button>
              </li>
            {{ end }}
          </ul>
        </section>

        <section class="rounded-3xl border border-gray-200 bg-white p-6 shadow-sm">
          <div class="flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between">
            <div class="space-y-1">
              <p class="text-xs font-semibold uppercase tracking-wide text-gray-500">{{ $view.Section.Eyebrow }}</p>
              <h3 class="text-xl font-semibold text-gray-900">{{ $view.Archive.Title }}</h3>
              <p class="text-sm text-gray-600">{{ $view.Archive.Description }}</p>
            </div>
            <a href="{{ $view.Archive.ActionHref }}" class="inline-flex items-center gap-2 rounded-xl border border-indigo-200 px-4 py-2 text-sm font-semibold text-indigo-700 hover:border-indigo-300">
              {{ $view.Archive.ActionLabel }}
              {{ template "icon" (dict "Name" "arrow-up-right" "Class" "h-4 w-4") }}
            </a>
          </div>
        </section>
      </div>
    </div>
  </div>
</section>
{{ end }}
