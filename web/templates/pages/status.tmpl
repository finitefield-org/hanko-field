{{ define "content" }}
{{ $status := $.Status }}
<section class="py-12">
  <div class="mx-auto w-full max-w-6xl space-y-10 px-4">
    {{ template "content_header" dict "Lang" $.Lang "Header" $status.Header }}

    {{ if $status.Banner }}
      {{ template "alert_banner" dict "Lang" $.Lang "Banner" $status.Banner }}
    {{ end }}

    <div class="grid gap-8 xl:grid-cols-[minmax(0,2fr),minmax(0,1fr)]">
      <div class="space-y-8">
        <section class="rounded-2xl border border-gray-200 bg-white p-6 shadow-sm">
          <div class="flex flex-wrap items-center justify-between gap-4">
            <div class="flex items-center gap-4">
              {{ if $status.Overview.Icon }}
                <span class="inline-flex h-11 w-11 flex-none items-center justify-center rounded-full bg-indigo-100 text-indigo-600">
                  {{ template "icon" (dict "Name" $status.Overview.Icon "Class" "h-5 w-5") }}
                </span>
              {{ end }}
              <div>
                <span class="inline-flex items-center gap-2 rounded-full px-4 py-1.5 text-sm font-semibold {{ $status.Overview.Badge }}">
                  {{ $status.Overview.StateLabel }}
                </span>
                {{ if $status.Overview.Updated }}
                  <p class="mt-2 text-sm text-gray-500">
                    {{ tlang $.Lang "status.overview.updated" }}
                    <time datetime="{{ $status.Overview.UpdatedISO }}">{{ $status.Overview.Updated }}</time>
                  </p>
                {{ end }}
              </div>
            </div>
          </div>
          {{ if $status.Services }}
            <div class="mt-6 flex flex-wrap gap-2">
              {{ range $svc := $status.Services }}
                <span class="inline-flex items-center gap-2 rounded-full border border-gray-200 bg-gray-50 px-3 py-1 text-xs font-medium {{ $svc.Badge }} shadow-sm">
                  {{ if $svc.Icon }}
                    {{ template "icon" (dict "Name" $svc.Icon "Class" "h-4 w-4") }}
                  {{ end }}
                  <span>{{ $svc.Name }}</span>
                  <span class="hidden text-[11px] font-normal text-gray-600 sm:inline">Â· {{ $svc.StatusLabel }}</span>
                </span>
              {{ end }}
            </div>
          {{ end }}
        </section>

        <section class="space-y-5">
          <div class="flex flex-col gap-2 md:flex-row md:items-center md:justify-between">
            <h2 class="text-xl font-semibold text-gray-900">{{ tlang $.Lang "status.components.title" }}</h2>
            <p class="text-sm text-gray-500">{{ tlang $.Lang "status.components.subtitle" }}</p>
          </div>
          <div class="grid gap-4 md:grid-cols-2">
            {{ range $comp := $status.Components }}
              <article class="flex h-full flex-col rounded-2xl border border-gray-200 bg-white p-5 shadow-sm transition hover:border-indigo-200 hover:shadow-md">
                <div class="flex items-start justify-between gap-3">
                  <div class="flex items-start gap-3">
                    {{ if $comp.Icon }}
                      <span class="inline-flex h-10 w-10 flex-none items-center justify-center rounded-xl bg-indigo-50 text-indigo-600">
                        {{ template "icon" (dict "Name" $comp.Icon "Class" "h-5 w-5") }}
                      </span>
                    {{ end }}
                    <div class="space-y-1">
                      <h3 class="text-base font-semibold text-gray-900">{{ $comp.Name }}</h3>
                      {{ if $comp.Description }}<p class="text-sm leading-relaxed text-gray-500">{{ $comp.Description }}</p>{{ end }}
                    </div>
                  </div>
                  <span class="inline-flex items-center rounded-full px-3 py-1 text-xs font-semibold {{ $comp.Badge }}">{{ $comp.StatusLabel }}</span>
                </div>
                {{ if $comp.Metrics }}
                  <dl class="mt-5 grid gap-3 text-sm sm:grid-cols-3">
                    {{ range $metric := $comp.Metrics }}
                      <div class="rounded-xl bg-gray-50 px-3 py-2">
                        <dt class="text-xs font-medium uppercase tracking-wide text-gray-500">{{ $metric.Label }}</dt>
                        <dd class="mt-1 text-lg font-semibold {{ if $metric.Accent }}{{ $metric.Accent }}{{ else }}text-gray-900{{ end }}">{{ $metric.Value }}</dd>
                        {{ if $metric.Tooltip }}<p class="mt-1 text-xs text-gray-500">{{ $metric.Tooltip }}</p>{{ end }}
                      </div>
                    {{ end }}
                  </dl>
                {{ end }}
                {{ if $comp.DocsURL }}
                  <div class="mt-5 pt-4">
                    <a href="{{ $comp.DocsURL }}" class="inline-flex items-center gap-2 text-sm font-semibold text-indigo-600 hover:text-indigo-500">
                      {{ $comp.DocsLabel }}
                      {{ template "icon" (dict "Name" "arrow-up-right" "Class" "h-4 w-4") }}
                    </a>
                  </div>
                {{ end }}
              </article>
            {{ end }}
          </div>
        </section>

        <section class="space-y-6">
          <div class="flex flex-col gap-3 md:flex-row md:items-center md:justify-between">
            <div>
              <h2 class="text-xl font-semibold text-gray-900">{{ tlang $.Lang "status.incidents.title" }}</h2>
              <p class="text-sm text-gray-500">{{ tlang $.Lang "status.incidents.subtitle" }}</p>
            </div>
            <form class="relative w-full md:w-80">
              <span class="pointer-events-none absolute inset-y-0 left-3 flex items-center text-gray-400">
                {{ template "icon" (dict "Name" "magnifying-glass" "Class" "h-4 w-4") }}
              </span>
              <input type="search"
                     name="incident-search"
                     placeholder="{{ $status.Filters.SearchPlaceholder }}"
                     class="w-full rounded-xl border border-gray-200 bg-white py-2 pl-9 pr-3 text-sm text-gray-700 shadow-sm focus:border-indigo-400 focus:outline-none focus:ring-2 focus:ring-indigo-300"
                     disabled>
            </form>
          </div>

          <div class="space-y-3 text-xs">
            {{ if $status.Filters.Severity }}
              <div class="flex flex-wrap items-center gap-2">
                <span class="font-semibold uppercase tracking-[0.2em] text-gray-400">{{ tlang $.Lang "status.filters.severity" }}</span>
                {{ range $chip := $status.Filters.Severity }}
                  <button type="button" class="inline-flex cursor-not-allowed items-center gap-2 rounded-full border border-gray-200 bg-white px-3 py-1 text-[11px] font-medium text-gray-600 shadow-sm">
                    {{ $chip.Label }}
                  </button>
                {{ end }}
              </div>
            {{ end }}
            {{ if $status.Filters.State }}
              <div class="flex flex-wrap items-center gap-2">
                <span class="font-semibold uppercase tracking-[0.2em] text-gray-400">{{ tlang $.Lang "status.filters.state" }}</span>
                {{ range $chip := $status.Filters.State }}
                  <button type="button" class="inline-flex cursor-not-allowed items-center gap-2 rounded-full border border-gray-200 bg-white px-3 py-1 text-[11px] font-medium text-gray-600 shadow-sm">
                    {{ $chip.Label }}
                  </button>
                {{ end }}
              </div>
            {{ end }}
            {{ if $status.Filters.Components }}
              <div class="flex flex-wrap items-center gap-2">
                <span class="font-semibold uppercase tracking-[0.2em] text-gray-400">{{ tlang $.Lang "status.filters.component" }}</span>
                {{ range $chip := $status.Filters.Components }}
                  <button type="button" class="inline-flex cursor-not-allowed items-center gap-2 rounded-full border border-gray-200 bg-white px-3 py-1 text-[11px] font-medium text-gray-600 shadow-sm">
                    {{ $chip.Label }}
                  </button>
                {{ end }}
              </div>
            {{ end }}
          </div>

          {{ if $status.Incidents }}
            <div class="space-y-4">
              {{ range $idx, $inc := $status.Incidents }}
                <details class="group rounded-2xl border border-gray-200 bg-white shadow-sm transition hover:border-indigo-200 hover:shadow-md" {{ if eq $idx 0 }}open{{ end }}>
                  <summary class="flex cursor-pointer list-none flex-col gap-4 px-6 py-5 md:flex-row md:items-start md:justify-between">
                    <div class="space-y-2">
                      <h3 class="text-base font-semibold text-gray-900">{{ $inc.Title }}</h3>
                      <div class="flex flex-wrap gap-2 text-xs font-medium">
                        {{ if $inc.StatusLabel }}<span class="rounded-full px-2 py-1 {{ $inc.StatusBadge }}">{{ $inc.StatusLabel }}</span>{{ end }}
                        {{ if $inc.ImpactLabel }}<span class="rounded-full px-2 py-1 {{ $inc.ImpactBadge }}">{{ $inc.ImpactLabel }}</span>{{ end }}
                      </div>
                    </div>
                    <div class="space-y-1 text-sm text-gray-500 md:text-right">
                      {{ if $inc.Started }}<div>{{ tlang $.Lang "status.incidents.started" }} <time datetime="{{ $inc.StartedISO }}">{{ $inc.Started }}</time></div>{{ end }}
                      {{ if $inc.Resolved }}<div>{{ tlang $.Lang "status.incidents.resolved" }} <time datetime="{{ $inc.ResolvedISO }}">{{ $inc.Resolved }}</time></div>{{ end }}
                    </div>
                  </summary>
                  {{ if $inc.Updates }}
                    <div class="border-t border-gray-100 px-6 py-5">
                      <ol class="space-y-4">
                        {{ range $update := $inc.Updates }}
                          <li class="relative rounded-xl border border-gray-200 bg-gray-50 p-4">
                            <div class="flex items-center justify-between gap-3">
                              <p class="text-xs font-semibold uppercase tracking-[0.2em] text-indigo-500">{{ $update.StatusLabel }}</p>
                              <time class="text-xs text-gray-500" datetime="{{ $update.TimestampISO }}">{{ $update.Timestamp }}</time>
                            </div>
                            {{ if $update.Body }}<p class="mt-3 whitespace-pre-line text-sm text-gray-700">{{ $update.Body }}</p>{{ end }}
                          </li>
                        {{ end }}
                      </ol>
                    </div>
                  {{ end }}
                </details>
              {{ end }}
            </div>
          {{ else }}
            <div class="rounded-2xl border border-dashed border-gray-300 bg-white p-6 text-center text-sm text-gray-500">
              {{ tlang $.Lang "status.incidents.empty" }}
            </div>
          {{ end }}
        </section>
      </div>

      <aside class="space-y-6">
        {{ if $status.Uptime.Periods }}
          <section class="rounded-2xl border border-gray-200 bg-white p-6 shadow-sm">
            <header class="space-y-1">
              <h2 class="text-lg font-semibold text-gray-900">{{ $status.Uptime.Title }}</h2>
              {{ if $status.Uptime.Subtitle }}<p class="text-sm text-gray-500">{{ $status.Uptime.Subtitle }}</p>{{ end }}
            </header>
            <div class="mt-4 flex flex-wrap gap-2">
              {{ range $period := $status.Uptime.Periods }}
                <span class="inline-flex items-center gap-2 rounded-full px-3 py-1 text-xs font-semibold {{ if $period.Selected }}bg-indigo-600 text-white shadow{{ else }}bg-gray-100 text-gray-600{{ end }}">
                  {{ $period.Label }}
                </span>
              {{ end }}
            </div>
            <div class="mt-5 space-y-4">
              {{ range $period := $status.Uptime.Periods }}
                <article class="rounded-xl border border-gray-200 bg-white/80 px-4 py-4">
                  <div class="flex items-baseline justify-between gap-3">
                    <div>
                      <p class="text-xs font-medium uppercase tracking-[0.2em] text-gray-400">{{ $period.Label }}</p>
                      <p class="text-2xl font-semibold text-gray-900">{{ $period.Percentage }}</p>
                    </div>
                    <div class="text-right text-xs text-gray-500">
                      {{ if $period.Target }}<p class="font-semibold text-indigo-600">{{ $period.Target }}</p>{{ end }}
                      {{ if $period.Delta }}<p class="{{ if $period.DeltaClass }}{{ $period.DeltaClass }}{{ else }}text-gray-500{{ end }}">{{ $period.Delta }}</p>{{ end }}
                    </div>
                  </div>
                  {{ if $period.Trend }}
                    <div class="mt-4">
                      <div class="flex items-end gap-2 rounded-lg bg-gradient-to-br from-gray-50 via-gray-100 to-white px-3 py-3">
                        {{ range $point := $period.Trend }}
                          <div class="group flex w-full flex-col items-center gap-2">
                            <span class="inline-flex w-2 rounded-full bg-indigo-400 group-hover:bg-indigo-500" style="height: {{ $point.BarHeight }};"></span>
                            <span class="text-[10px] font-medium uppercase tracking-wide text-gray-400">{{ $point.Label }}</span>
                          </div>
                        {{ end }}
                      </div>
                      <div class="sr-only">
                        {{ range $point := $period.Trend }}<p>{{ $point.Label }} {{ $point.Value }}</p>{{ end }}
                      </div>
                    </div>
                  {{ end }}
                </article>
              {{ end }}
            </div>
          </section>
        {{ end }}

        {{ if $status.Subscriptions }}
          <section class="rounded-2xl border border-gray-200 bg-white p-6 shadow-sm">
            <header class="space-y-1">
              <h2 class="text-lg font-semibold text-gray-900">{{ tlang $.Lang "status.subscriptions.title" }}</h2>
              <p class="text-sm text-gray-500">{{ tlang $.Lang "status.subscriptions.subtitle" }}</p>
            </header>
            <div class="mt-5 space-y-4">
              {{ range $sub := $status.Subscriptions }}
                <article class="rounded-xl border border-gray-100 bg-gray-50 px-4 py-4">
                  <div class="flex items-start gap-3">
                    {{ if $sub.Icon }}
                      <span class="inline-flex h-10 w-10 flex-none items-center justify-center rounded-full bg-white text-indigo-500 shadow-sm">
                        {{ template "icon" (dict "Name" $sub.Icon "Class" "h-5 w-5") }}
                      </span>
                    {{ end }}
                    <div class="flex-1 space-y-2">
                      <div>
                        <h3 class="text-sm font-semibold text-gray-900">{{ $sub.Title }}</h3>
                        {{ if $sub.Description }}<p class="text-sm text-gray-500">{{ $sub.Description }}</p>{{ end }}
                      </div>
                      <div class="flex flex-wrap gap-2">
                        {{ if $sub.PrimaryURL }}
                          <a href="{{ $sub.PrimaryURL }}" class="inline-flex items-center justify-center rounded-full bg-indigo-600 px-3 py-2 text-xs font-semibold text-white hover:bg-indigo-500">{{ $sub.PrimaryLabel }}</a>
                        {{ else if $sub.PrimaryLabel }}
                          <span class="inline-flex items-center justify-center rounded-full bg-indigo-600 px-3 py-2 text-xs font-semibold text-white">{{ $sub.PrimaryLabel }}</span>
                        {{ end }}
                        {{ if $sub.SecondaryURL }}
                          <a href="{{ $sub.SecondaryURL }}" class="inline-flex items-center justify-center rounded-full border border-indigo-100 bg-white px-3 py-2 text-xs font-semibold text-indigo-600 hover:border-indigo-200 hover:text-indigo-500">{{ $sub.SecondaryLabel }}</a>
                        {{ else if $sub.SecondaryLabel }}
                          <span class="inline-flex items-center justify-center rounded-full border border-indigo-100 bg-white px-3 py-2 text-xs font-semibold text-indigo-600">{{ $sub.SecondaryLabel }}</span>
                        {{ end }}
                      </div>
                    </div>
                  </div>
                </article>
              {{ end }}
            </div>
          </section>
        {{ end }}

        {{ if $status.Support }}
          <section class="rounded-2xl border border-gray-200 bg-white p-6 shadow-sm">
            <header class="space-y-1">
              <h2 class="text-lg font-semibold text-gray-900">{{ tlang $.Lang "status.support.title" }}</h2>
              <p class="text-sm text-gray-500">{{ tlang $.Lang "status.support.subtitle" }}</p>
            </header>
            <div class="mt-4 space-y-3">
              {{ range $link := $status.Support }}
                <a href="{{ $link.URL }}" class="flex items-start gap-3 rounded-xl border border-gray-100 bg-gray-50 px-4 py-3 transition hover:border-indigo-200 hover:bg-white">
                  {{ if $link.Icon }}
                    <span class="inline-flex h-10 w-10 flex-none items-center justify-center rounded-full bg-white text-indigo-500 shadow-sm">
                      {{ template "icon" (dict "Name" $link.Icon "Class" "h-5 w-5") }}
                    </span>
                  {{ end }}
                  <div class="space-y-1">
                    <p class="text-sm font-semibold text-gray-900">{{ $link.Label }}</p>
                    {{ if $link.Description }}<p class="text-sm text-gray-500">{{ $link.Description }}</p>{{ end }}
                  </div>
                </a>
              {{ end }}
            </div>
          </section>
        {{ end }}
      </aside>
    </div>
  </div>
</section>
{{ end }}
