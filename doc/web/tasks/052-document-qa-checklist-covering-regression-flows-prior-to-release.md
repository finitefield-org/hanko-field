# リリース前回帰テスト QA チェックリスト

**親セクション:** 9. パフォーマンス・アクセシビリティ・QA
**タスクID:** 052

## 目的
主要なユーザーフローに対する回帰テストを体系化し、リリース前に重大な不具合が残存しないことを保証する。

## 適用範囲
- Web チームが管理する本番リリースおよびホットフィックス前の QA フェーズ
- コアフロー（ランディング〜チェックアウト、アカウント管理、デザイン作成・共有）と主要なクロスカッティング要件（アクセシビリティ、性能、エラーハンドリング）

## 前提条件
- ステージング環境が本番と同等の設定で最新化されていること
- リリース候補ビルドがデプロイ済みであること
- 主要な外部依存（支払いゲートウェイ、メール送信、ストレージ）がステージングで動作確認済みであること
- テスト用データ（ユーザー、デザイン、注文）が準備済みであり、必要に応じてリセット手順が用意されていること

## 体制と責任
- QA リード: チェックリストの更新、テスト計画の共有、サインオフ判断
- 開発担当: コードオーナーとして不具合再現の支援と修正
- PM: リリース判定およびブロッカーの優先順位付け
- CS: 既知の顧客報告事項のフィードバック提供

## 実施タイムライン（例）
- T-5 営業日: リリースノート草案・影響範囲の共有、チェックリスト更新
- T-4 営業日: 回帰テスト開始、優先度 P0/P1 の完了を目標
- T-2 営業日: 残りシナリオ完了、バグ修正の再テスト
- T-1 営業日: QA サインオフ、PM/開発とリリース可否判定
- T+1 営業日: レトロスペクティブ、チェックリスト改善の反映

## テスト環境とツール
- ステージング URL: `https://staging.hanko-field.example`
- データベース: Firestore ステージングプロジェクト（読み書き権限確認）
- ストレージ: Firebase Storage ステージングバケット
- アカウント: テスト用 Google/Facebook/Firebase Auth アカウント
- バグトラッキング: Jira（プロジェクト: HF-WEB）、Triage SLA: ブロッカー 4h、メジャー 1d、マイナー 3d

## 回帰チェックリスト
### 1. ランディング〜購入フロー
| No. | シナリオ | 手順 | 確認ポイント |
| --- | --- | --- | --- |
| 1-1 | ランディング表示 | ルート `/` へアクセス | Hero 表示、主要 CTA 動作、LCP < 2.5s |
| 1-2 | テンプレ閲覧 | テンプレート一覧→フィルター操作 | テンプレ画像表示、フィルター結果反映 |
| 1-3 | 商品詳細 | テンプレ詳細→バリエーション切替 | ギャラリー切替、在庫・価格表示 |
| 1-4 | カート追加 | 詳細からカート追加→カート表示 | カート内デザイン保持、数量変更が反映 |
| 1-5 | チェックアウト | 住所入力→配送選択→支払い→完了 | 入力バリデーション、支払い成功メール送信 |
| 1-6 | キャンセル/失敗 | 支払い失敗ケースを再現 | エラー表示、再試行可能、部分課金なし |

### 2. アカウント管理フロー
| No. | シナリオ | 手順 | 確認ポイント |
| --- | --- | --- | --- |
| 2-1 | サインアップ | メール/パスワード登録 | 認証メール送信、ログイン状態保持 |
| 2-2 | SNS 連携 | Google 連携ログイン | 既存ユーザーにリンク、二重登録なし |
| 2-3 | プロフィール更新 | `/account` でプロフィール編集 | 入力保存、リロード後も反映 |
| 2-4 | 住所管理 | 住所追加・編集・削除 | 必須項目チェック、デフォルト指定が維持 |
| 2-5 | 注文履歴 | 注文一覧→詳細表示 | ステータス、領収書リンク、返品導線 |
| 2-6 | セキュリティ | パスワード変更→再ログイン | セッション無効化、2FA プロンプト表示 |

### 3. デザイン作成・共有フロー
| No. | シナリオ | 手順 | 確認ポイント |
| --- | --- | --- | --- |
| 3-1 | デザイン新規作成 | `/design/new` でテンプレ選択 | 編集画面読み込み、初期データ保存 |
| 3-2 | 編集操作 | テキスト変更→フォント変更→プレビュー | 変更即時反映、バージョン保存 |
| 3-3 | AI 提案 | AI サジェスト実行→採用/破棄 | ステータス更新、再計算エラーなし |
| 3-4 | バージョン管理 | 過去バージョンへロールバック | 差分表示、現在版に反映 |
| 3-5 | 共有/ダウンロード | 共有リンク発行→アクセス→DL | 期限/権限制御、署名 URL 有効 |
| 3-6 | ライブラリ | ライブラリ一覧→複製→削除 | 操作ログ記録、同期ずれなし |

### 4. クロスカッティングチェック
- `アクセシビリティ`: キーボード操作、スクリーンリーダーでのラベル確認、コントラスト 4.5:1 以上
- `パフォーマンス`: 主要ページで Lighthouse パフォーマンス 80 以上、画像最適化が有効
- `エラーハンドリング`: 404/500 ページ表示、ネットワーク遅延時のローディング表示
- `通知`: 重要操作後のメール送信（注文完了、パスワード変更、共有リンク）
- `ログ/トレース`: Cloud Logging にエラーが記録されていること、Stackdriver Alert がトリガーされていないこと

## 実行記録テンプレート
- 日付 / 実行者
- チェックリスト完了状況（例: 24/26 完了）
- 発見バグ一覧（Jira チケット、優先度、担当者）
- 残課題・リスクと対応期限

## 不具合管理とサインオフ
- 新規バグは Jira に登録し、`HF-WEB-QA` ボードでトリアージ
- ブロッカー/P0 は修正完了までリリース停止、P1 は PM 承認でリリース可否判断
- 修正後は担当者以外が再テストし、`Ready for Release` ラベルを付与
- QA リードが全 P0/P1 クローズ、P2 以上の既知問題をリスト化しサインオフ

## 継続的改善
- リリース後 1 営業日以内にレトロを実施し、漏れたシナリオや対応時間を振り返る
- チェックリストの更新箇所は `doc/web/tasks/052` に Pull Request で記録し、履歴を残す
- メトリクス（バグ再発率、実行時間、カバレッジ）を四半期ごとにレビューし、テスト自動化候補を洗い出す
