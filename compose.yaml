services:
  workspace:
    build: .
    volumes:
      - .:/workspace:cached
      - ../firebase-sdk-rust:/firebase-sdk-rust:cached
    ports:
      - "3050:3050"
      - "3051:3051"
      - "3052:3052"
    environment:
      - FIREBASE_PROJECT_ID=${FIREBASE_PROJECT_ID:-hanko-field-test}
      - GOOGLE_CLOUD_PROJECT=${FIREBASE_PROJECT_ID:-hanko-field-test}
      - FIRESTORE_PROJECT_ID=${FIREBASE_PROJECT_ID:-hanko-field-test}
      - API_FIREBASE_PROJECT_ID=${FIREBASE_PROJECT_ID:-hanko-field-test}
      - API_FIRESTORE_PROJECT_ID=${FIREBASE_PROJECT_ID:-hanko-field-test}
      - API_STORAGE_ASSETS_BUCKET=${API_STORAGE_ASSETS_BUCKET:-local-assets}
      - API_GEMINI_API_KEY=${API_GEMINI_API_KEY:-}
      - API_GEMINI_MODEL=${API_GEMINI_MODEL:-gemini-2.0-flash}
      - API_STORAGE_SIGNER_KEY=${API_STORAGE_SIGNER_KEY:-secret://Storage.SignerKey}
      - API_PSP_STRIPE_API_KEY=${API_PSP_STRIPE_API_KEY:-secret://PSP.StripeAPIKey}
      - API_PSP_STRIPE_WEBHOOK_SECRET=${API_PSP_STRIPE_WEBHOOK_SECRET:-secret://PSP.StripeWebhookSecret}
      - API_WEBHOOK_SIGNING_SECRET=${API_WEBHOOK_SIGNING_SECRET:-secret://Webhooks.SigningSecret}
      - ADMIN_ALLOW_INSECURE_AUTH=${ADMIN_ALLOW_INSECURE_AUTH:-1}
      - HANKO_WEB_API_BASE_URL=${HANKO_WEB_API_BASE_URL:-http://localhost:3050}
      - GOOGLE_APPLICATION_CREDENTIALS=${GOOGLE_APPLICATION_CREDENTIALS:-/workspace/hanko-field-firebase-adminsdk-fbsvc.json}
      - API_FIREBASE_CREDENTIALS_FILE=${API_FIREBASE_CREDENTIALS_FILE:-/workspace/hanko-field-firebase-adminsdk-fbsvc.json}
    command: sleep infinity
